<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/markdown/webster-generating-checklist-initial-state.md.vm at 2019-09-05 17:26
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190905" />
    <meta http-equiv="Content-Language" content="en" />
    <title>OakPAL - OakPAL Maven Plugin &#x2013; Webster: Generating Checklist Initial State</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
    <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-37073514-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../index.html" id="bannerLeft"><h2>OakPAL - Oak Package Acceptance Library</h2>
</a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2019-09-05 17:26<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.4.1</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="http://wiki.github.com/adamcin/oakpal/frequently-asked-questions" class="externalLink" title="FAQ">FAQ</a></li>
      <li class="pull-right"><a href="http://wiki.github.com/adamcin/oakpal/" class="externalLink" title="Wiki">Wiki</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="plugin-info.html" title="Goals"><span class="none"></span>Goals</a></li>
    <li><a href="usage.html" title="Usage"><span class="none"></span>Usage</a></li>
    <li><a href="webster-managing-nodetypes.html" title="Webster: Managing Nodetypes"><span class="none"></span>Webster: Managing Nodetypes</a></li>
    <li><a href="writing-a-script-check.html" title="Writing a Script Check"><span class="none"></span>Writing a Script Check</a></li>
    <li><a href="../oakpal-core/the-basic-checklist.html" title="The Basic Checklist"><span class="none"></span>The Basic Checklist</a></li>
    <li><a href="../oakpal-core/publishing-a-checklist.html" title="Publishing a Checklist"><span class="none"></span>Publishing a Checklist</a></li>
    <li class="active"><a href="#"><span class="none"></span>Webster: Generating Checklist Initial State</a></li>
    <li><a href="apidocs/index.html" title="JavaDocs"><span class="none"></span>JavaDocs</a></li>
      <li class="nav-header">Resources @ Github</li>
    <li><a href="https://github.com/adamcin/oakpal" class="externalLink" title="Get the Source"><span class="none"></span>Get the Source</a></li>
    <li><a href="https://github.com/adamcin/oakpal/issues" class="externalLink" title="Report Issues"><span class="none"></span>Report Issues</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org" title="Build with Maven" class="builtBy"><img class="builtBy"  alt="Build with Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Webster: Generating Checklist Initial State</h1>
<p>Sometimes, an OakPAL Checklist may need to provide a significant amount of initial JCR state to support progress check functionality. This initial state is defined by the following keys:</p>
<ul>

<li><tt>jcrNamespaces</tt>: An array of objects that map a namespace <tt>prefix</tt> to a namespace <tt>uri</tt>, as in:</li>
</ul>

<div>
<div>
<pre class="source">&quot;jcrNamespaces&quot;:[
  {&quot;prefix&quot;:&quot;sling&quot;,&quot;uri&quot;:&quot;http://...&quot;},
  {&quot;prefix&quot;:&quot;granite&quot;,&quot;uri&quot;:&quot;http://...&quot;}
]
</pre></div></div>

<ul>

<li><tt>jcrNodetypes</tt>: A map of <tt>JsonCnd</tt>-formatted node type definitions, for example:</li>
</ul>

<div>
<div>
<pre class="source">&quot;jcrNodetypes&quot;:{
  &quot;sling:Folder&quot;:{
    &quot;&gt;&quot;:[
      &quot;nt:folder&quot;
    ],
    &quot;-&quot;:[
      {
        &quot;name&quot;:&quot;*&quot;,
        &quot;type&quot;:&quot;undefined&quot;
      },
      {
        &quot;name&quot;:&quot;*&quot;,
        &quot;type&quot;:&quot;undefined&quot;,
        &quot;@&quot;:[
          &quot;multiple&quot;
        ]
      }
    ],
    &quot;+&quot;:[
      {
        &quot;name&quot;:&quot;*&quot;,
        &quot;types&quot;:[
          &quot;nt:base&quot;
        ],
        &quot;=&quot;:&quot;sling:Folder&quot;,
        &quot;@&quot;:[
          &quot;version&quot;
        ]
      }
    ]
  },
  &quot;sling:OrderedFolder&quot;:{
    &quot;&gt;&quot;:[
      &quot;sling:Folder&quot;
    ],
    &quot;@&quot;:[
      &quot;orderable&quot;
    ],
    &quot;+&quot;:[
      {
        &quot;name&quot;:&quot;*&quot;,
        &quot;types&quot;:[
          &quot;nt:base&quot;
        ],
        &quot;=&quot;:&quot;sling:OrderedFolder&quot;,
        &quot;@&quot;:[
          &quot;version&quot;
        ]
      }
    ]
  }
}
</pre></div></div>

<ul>

<li><tt>forcedRoots</tt>: An array of root paths to create with optional <tt>primaryType</tt> and <tt>mixinTypes</tt> declared, such as:</li>
</ul>

<div>
<div>
<pre class="source">&quot;forcedRoots&quot;:[
  {
    &quot;path&quot;:&quot;/libs/fd/xfaforms/clientlibs/loadingProfile&quot;,
    &quot;primaryType&quot;:&quot;cq:ClientLibraryFolder&quot;,
    &quot;mixinTypes&quot;:[
      &quot;granite:FinalArea&quot;
    ]
  },
  {
    &quot;path&quot;:&quot;/libs/fd/xfaforms/clientlibs/manifest&quot;,
    &quot;primaryType&quot;:&quot;nt:folder&quot;,
    &quot;mixinTypes&quot;:[
      &quot;granite:InternalArea&quot;
    ]
  }
]
</pre></div></div>

<p>Webster can be used to manage this state by selecting forcedRoots by JCR path, by node type, or by query. The namespaces and node types required by these forcedRoots are automatically included, as well as any transitive dependencies declared by the selected node type definitions.</p>
<p>To enable this functionality, you must first add a <tt>oakpal-maven-plugin</tt> configuration to your <tt>jar</tt> module that hosts your oakpal checklist:</p>

<div>
<div>
<pre class="source">&lt;plugin&gt;
    &lt;groupId&gt;net.adamcin.oakpal&lt;/groupId&gt;
    &lt;artifactId&gt;oakpal-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.4.1&lt;/version&gt;
    &lt;configuration&gt;
        &lt;websterTargets&gt;
            &lt;checklist&gt;
                &lt;file&gt;src/main/resources/OAKPAL-INF/checklist.json&lt;/file&gt;
                &lt;config&gt;
                &lt;/config&gt;
            &lt;/checklist&gt;
        &lt;/websterTargets&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div></div>

<p>Within the <tt>config</tt> element, you will want to specify at least one of these selectors:</p>
<ul>

<li>

<p><tt>selectPaths</tt>: Webster will attempt to get a node for each specified <tt>path</tt> element, and if it exists, it will add that node to the checklist as a <tt>forcedRoot</tt>.</p>
</li>
<li>

<p><tt>selectNodeTypes</tt>: Webster will run a query for all nodes that match the list of <tt>nodeType</tt> elements. By default, the query will match each node type <i>exactly</i>, unless you prefix that node type name with a <tt>+</tt> indicating a covariant, or subtype, match is desired. Practically speaking, an explicitly selected type translates to a JCR query of the form, <tt>FROM [nt:base] WHERE [jcr:primaryType] = &lt;type&gt; OR [jcr:mixinTypes] = &lt;type&gt;</tt>, while a covariant (<tt>+</tt>) type translates to a query in the form of, <tt>FROM [&lt;type&gt;]</tt>. Any node types listed in the <tt>selectNodeTypes</tt> element will be exported in the <tt>jcrNodetypes</tt> object by default.</p>
</li>
<li>

<p><tt>selectQuery</tt>: Webster will execute any arbitrary JCR query that you specify as the value for the <tt>selectQuery</tt> element, and add any returned nodes to the checklist as <tt>forcedRoot</tt> objects.</p>
</li>
</ul>
<p>So, for example, to export every node with a <tt>mix:title</tt> type or subtype, you could use the following config:</p>

<div>
<div>
<pre class="source">&lt;plugin&gt;
    &lt;groupId&gt;net.adamcin.oakpal&lt;/groupId&gt;
    &lt;artifactId&gt;oakpal-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.4.1&lt;/version&gt;
    &lt;configuration&gt;
        &lt;websterTargets&gt;
            &lt;checklist&gt;
                &lt;file&gt;src/main/resources/OAKPAL-INF/checklist.json&lt;/file&gt;
                &lt;config&gt;
                    &lt;selectNodeTypes&gt;
                        &lt;nodeType&gt;+mix:title&lt;/nodeType&gt;
                    &lt;/selectNodeTypes&gt;
                &lt;/config&gt;
            &lt;/checklist&gt;
        &lt;/websterTargets&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div></div>

<p>Some additional config properties are supported:</p>
<ul>

<li>

<p><tt>scopePaths</tt>: (<tt>List&lt;Rule&gt;</tt>) Limit the scope of <tt>forcedRoot</tt> paths affected by the webster execution. You can export different subsets of <tt>forcedRoot</tt> elements in the same checklist by subdividing the scope for each execution and specifying an <tt>updatePolicy</tt> of <tt>merge</tt> or <tt>replace</tt>.</p>
</li>
<li>

<p><tt>updatePolicy</tt>: ForcedRoot update policy governs how repeated webster executions will affect previously exported <tt>forcedRoot</tt> paths. Can be</p>
</li>
<li>

<p><tt>merge</tt>: only replace forced roots when an exported root has the same path as an existing root. Otherwise, don&#x2019;t delete existing <tt>forcedRoot</tt> elements.</p>
</li>
<li>

<p><tt>replace</tt>: delete all <tt>scopePaths</tt>-included <tt>forcedRoot</tt> elements before exporting new <tt>forcedRoot</tt> elements, which will also be filtered by <tt>scopePaths</tt>.</p>
</li>
<li>

<p><tt>truncate</tt>: delete all existing <tt>forcedRoot</tt> elements, regardless of <tt>scopePaths</tt>, before exporting new <tt>forcedRoot</tt> elements, which will be filtered by <tt>scopePaths</tt>.</p>
</li>
<li>

<p><tt>nodeTypeFilters</tt>: (<tt>List&lt;Rule&gt;</tt>) Limit the possible node types selected for export in <tt>jcrNodetypes</tt> and <tt>forcedRoots</tt> according to whether they are included by this list of filter rules. <tt>forcedRoot</tt> elements with an excluded primaryType or mixinTypes value will still be exported, but without the excluded type names in either of those properties.</p>
</li>
<li>

<p><tt>exportNodeTypes</tt>: Ensure that this list of <tt>nodeType</tt> elements are also included in the exported <tt>jcrNodetypes</tt> object, even if no matching <tt>forcedRoots</tt> are exported. By default, each <tt>nodeType</tt> element will select a single node type <i>exactly</i>, unless you prefix that node type name with a <tt>+</tt> indicating a covariant, or subtype, match is desired. This has essentially the same effect as <tt>selectNodeTypes</tt>, except that it doesn&#x2019;t affect the selection of nodes exported as <tt>forcedRoots</tt>.</p>
</li>
</ul>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2017&#x2013;2019.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>